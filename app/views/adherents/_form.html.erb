

<%= simple_form_for(@adherent) do |f| %>
  <%= f.error_notification %>

  <div class="form-inputs">
    <%= f.file_field :avatar %>
    <%= f.input :nom %>
    <%= f.input :prenom %>
    <%= f.input :sexe, collection: Adherent::SEXE %>
    <%= f.input :status_matrimonial, collection: Adherent::MATRIMONIAL %>
    <%= f.input :date_de_naissance, :as => :date_picker %>
    <%= f.input :lieu_de_naissance %>
    <%= f.input :adresse %>
    <%= f.input :telephone1 %>
    <%= f.input :telephone2 %>
    <%= f.input :email %>
    <%= f.input :password_txt %>
    <%= f.input :password_txt_confirmation %>
    <%= f.input :montant_cotisation %>
    <%= f.input :groupe_id, :as => :hidden %>

    <div class="form-group">
      <label class="control-label" for="groupe">Groupe</label>
      <input class="string form-control" id="groupe" name="groupe" value="<%= @adherent.groupe.nom if @adherent.groupe %>" type="text">
    </div>
    </div>
  </div>

  <div class="form-actions">
    <%= f.button :submit %>
  </div>
<% end %>

<script type="text/javascript">
    $('.datetimepicker').datetimepicker();

    $('#groupe').autocomplete({
        minLength: 3,
        source: function(request, response) {
            $.ajax({
                url: "<%= groupes_path %>",
                method: 'post',
                dataType: "json",
                data: {nom: request.term},
                success: function( data ) {
                    console.log(data);
                    response( $.map( data, function( item ) {
                        //alert(item.label);
                        return {
                            label: item.nom,
                            value: item.nom,
                            id: item.id
                        }
                    }));
                }
            });
        },
        select: function (event, ui) {
            $("#adherent_groupe_id").val(ui.item.id);  // ui.item.value contains the id of the selected label
            return false;
        }
    });
</script>

